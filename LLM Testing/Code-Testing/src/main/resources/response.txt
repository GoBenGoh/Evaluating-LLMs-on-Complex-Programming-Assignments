{  "id": "chatcmpl-7rnkUr9fBqfIghUuQan6hFnS7INzS",  "object": "chat.completion",  "created": 1693056974,  "model": "gpt-3.5-turbo-16k-0613",  "choices": [    {      "index": 0,      "message": {        "role": "assistant",        "content": "```\r\npackage nz.ac.auckland.se281;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.HashMap;\r\nimport java.util.List;\r\nimport java.util.Map;\r\n\r\npublic class InsuranceSystem {\r\n    private final Map<String, Profile> database;\r\n    private Profile loadedProfile;\r\n\r\n    public InsuranceSystem() {\r\n        database = new HashMap<>();\r\n        loadedProfile = null;\r\n    }\r\n\r\n    public void printDatabase() {\r\n        int profileCount = database.size();\r\n        if (profileCount == 0) {\r\n            MessageCli.PRINT_DB_POLICY_COUNT.printMessage(\"0\", \"s\", \".\");\r\n        } else if (profileCount == 1) {\r\n            MessageCli.PRINT_DB_POLICY_COUNT.printMessage(\"1\", \"\", \":\");\r\n            printProfile(database.get(1));\r\n        } else {\r\n            MessageCli.PRINT_DB_POLICY_COUNT.printMessage(String.valueOf(profileCount), \"s\", \":\");\r\n            for (Profile profile : database.values()) {\r\n                printProfile(profile);\r\n            }\r\n        }\r\n    }\r\n\r\n    public void createNewProfile(String userName, String age) {\r\n        if (userName.length() < 3) {\r\n            MessageCli.INVALID_USERNAME_TOO_SHORT.printMessage(userName);\r\n            return;\r\n        }\r\n\r\n        userName = toTitleCase(userName);\r\n\r\n        if (database.containsKey(userName)) {\r\n            MessageCli.INVALID_USERNAME_NOT_UNIQUE.printMessage(userName);\r\n            return;\r\n        }\r\n\r\n        int ageValue;\r\n        try {\r\n            ageValue = Integer.parseInt(age);\r\n        } catch (NumberFormatException e) {\r\n            MessageCli.INVALID_AGE.printMessage(age, userName);\r\n            return;\r\n        }\r\n\r\n        if (ageValue <= 0) {\r\n            MessageCli.INVALID_AGE.printMessage(age, userName);\r\n            return;\r\n        }\r\n\r\n        Profile newProfile = new Profile(userName, ageValue);\r\n        database.put(userName, newProfile);\r\n        MessageCli.PROFILE_CREATED.printMessage(userName, age);\r\n    }\r\n\r\n    public void loadProfile(String userName) {\r\n        if (loadedProfile != null) {\r\n            if (loadedProfile.getUserName().equalsIgnoreCase(userName)) {\r\n                MessageCli.PROFILE_LOADED.printMessage(userName);\r\n                return;\r\n            } else {\r\n                MessageCli.CANNOT_CREATE_WHILE_LOADED.printMessage(loadedProfile.getUserName());\r\n                return;\r\n            }\r\n        }\r\n\r\n        if (!database.containsKey(userName)) {\r\n            MessageCli.NO_PROFILE_FOUND_TO_LOAD.printMessage(userName);\r\n            return;\r\n        }\r\n\r\n        loadedProfile = database.get(userName);\r\n        MessageCli.PROFILE_LOADED.printMessage(userName);\r\n    }\r\n\r\n    public void unloadProfile() {\r\n        if (loadedProfile == null) {\r\n            MessageCli.NO_PROFILE_LOADED.printMessage();\r\n            return;\r\n        }\r\n\r\n        loadedProfile = null;\r\n        MessageCli.PROFILE_UNLOADED.printMessage();\r\n    }\r\n\r\n    public void deleteProfile(String userName) {\r\n        if (loadedProfile != null && loadedProfile.getUserName().equalsIgnoreCase(userName)) {\r\n            MessageCli.CANNOT_DELETE_PROFILE_WHILE_LOADED.printMessage(userName);\r\n            return;\r\n        }\r\n\r\n        if (!database.containsKey(userName)) {\r\n            MessageCli.NO_PROFILE_FOUND_TO_DELETE.printMessage(userName);\r\n            return;\r\n        }\r\n\r\n        database.remove(userName);\r\n        MessageCli.PROFILE_DELETED.printMessage(userName);\r\n    }\r\n\r\n    public void createPolicy(Main.PolicyType type, String[] options) {\r\n        if (loadedProfile == null) {\r\n            MessageCli.NO_PROFILE_FOUND_TO_CREATE_POLICY.printMessage();\r\n            return;\r\n        }\r\n\r\n        if (type == Main.PolicyType.LIFE && loadedProfile.getLifePolicy() != null) {\r\n            MessageCli.ALREADY_HAS_LIFE_POLICY.printMessage(loadedProfile.getUserName());\r\n            return;\r\n        }\r\n\r\n        if (type == Main.PolicyType.LIFE && loadedProfile.getAge() > Profile.MAX_LIFE_POLICY_AGE) {\r\n            MessageCli.OVER_AGE_LIMIT_LIFE_POLICY.printMessage(loadedProfile.getUserName());\r\n            return;\r\n        }\r\n\r\n        Policy newPolicy;\r\n        switch (type) {\r\n            case HOME:\r\n                newPolicy = new HomePolicy(options[0], options[1], Boolean.parseBoolean(options[2]));\r\n                break;\r\n            case CAR:\r\n                newPolicy = new CarPolicy(options[0], options[1], options[2], Boolean.parseBoolean(options[3]));\r\n                break;\r\n            case LIFE:\r\n                newPolicy = new LifePolicy(options[0]);\r\n                break;\r\n            default:\r\n                return;\r\n        }\r\n\r\n        loadedProfile.addPolicy(newPolicy);\r\n        MessageCli.NEW_POLICY_CREATED.printMessage(type.toString(), loadedProfile.getUserName());\r\n        calculateDiscount();\r\n    }\r\n\r\n    private void printProfile(Profile profile) {\r\n        int profileNumber = getProfileNumber(profile);\r\n        String username = profile.getUserName();\r\n        int age = profile.getAge();\r\n\r\n        MessageCli.PRINT_DB_PROFILE_HEADER_MINIMAL.printMessage(profileNumber, username, age);\r\n        for (Policy policy : profile.getPolicies()) {\r\n            printPolicy(policy);\r\n        }\r\n    }\r\n\r\n    private void printPolicy(Policy policy) {\r\n        if (policy instanceof CarPolicy) {\r\n            CarPolicy carPolicy = (CarPolicy) policy;\r\n            String makeAndModel = carPolicy.getMakeAndModel();\r\n            String licensePlate = carPolicy.getLicensePlate();\r\n            boolean hasMechanicalWarranty = carPolicy.hasMechanicalWarranty();\r\n            MessageCli.PRINT_DB_CAR_POLICY.printMessage(makeAndModel, carPolicy.getSumInsured(),\r\n                    carPolicy.getPremium(), carPolicy.getPremiumAfterDiscount());\r\n        } else if (policy instanceof HomePolicy) {\r\n            HomePolicy homePolicy = (HomePolicy) policy;\r\n            String propertyAddress = homePolicy.getPropertyAddress();\r\n            boolean isRental = homePolicy.isRental();\r\n            MessageCli.PRINT_DB_HOME_POLICY.printMessage(propertyAddress, homePolicy.getSumInsured(),\r\n                    homePolicy.getPremium(), homePolicy.getPremiumAfterDiscount());\r\n        } else if (policy instanceof LifePolicy) {\r\n            LifePolicy lifePolicy = (LifePolicy) policy;\r\n            MessageCli.PRINT_DB_LIFE_POLICY.printMessage(lifePolicy.getSumInsured(), lifePolicy.getPremium(),\r\n                    lifePolicy.getPremiumAfterDiscount());\r\n        }\r\n    }\r\n\r\n    private int getProfileNumber(Profile profile) {\r\n        List<Profile> profiles = new ArrayList<>(database.values());\r\n        profiles.sort((p1, p2) -> p1.getUserName().compareToIgnoreCase(p2.getUserName()));\r\n\r\n        int index = profiles.indexOf(profile);\r\n        return index + 1;\r\n    }\r\n\r\n    private void calculateDiscount() {\r\n        int policyCount = loadedProfile.getPolicies().size();\r\n        if (policyCount == 2) {\r\n            MessageCli.DISCOUNT_TWO.printMessage();\r\n        } else if (policyCount > 2) {\r\n            MessageCli.DISCOUNT_MULTIPLE.printMessage();\r\n        }\r\n    }\r\n\r\n    private String toTitleCase(String input) {\r\n        String[] words = input.toLowerCase().split(\" \");\r\n        StringBuilder titleCase = new StringBuilder();\r\n        for (String word : words) {\r\n            titleCase.append(word.substring(0, 1).toUpperCase()).append(word.substring(1)).append(\" \");\r\n        }\r\n        return titleCase.toString().trim();\r\n    }\r\n}\r\n```"      },      "finish_reason": "stop"    }  ],  "usage": {    "prompt_tokens": 8858,    "completion_tokens": 1399,    "total_tokens": 10257  }}
